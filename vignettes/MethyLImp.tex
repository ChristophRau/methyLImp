 
---
title: "MethyLImp"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{missMethy}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

\newcommand{\Rfunction}[1]{{\texttt{#1}}}
\newcommand{\Robject}[1]{{\texttt{#1}}}
\newcommand{\Rpackage}[1]{{\textit{#1}}}
\newcommand{\Rclass}[1]{{\textit{#1}}}

\title{The \Rpackage{methyLImp} Package}
\author{Pietro Di Lena}
\begin{document}
maketitle
\section{ About the package }
The \Rpackage{methyLImp} implements a missing data imputation method based on single imputation linear regression,
especially designed for and tested on DNA methylation data [1].

\section{Installation}

The package doesn't have any dependencies from other Bioconductor packages.

Installing the latest package from a local copy (assuming it is in the current working
directory of your R session):

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{install.packages}\hlstd{(}\hlstr{'methyLImp_0.9.9.tar.gz'}\hlstd{,} \hlkwc{repos}\hlstd{=}\hlkwa{NULL}\hlstd{,} \hlkwc{type}\hlstd{=}\hlstr{'source'}\hlstd{)}
\end{alltt}
\end{kframe}
\end{knitrout}

\section{Trying it out}
The package contains a single sample of a full 450K array data, \Robject{GSM1647847}, which can be used to explore the function quickly:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{library}\hlstd{(}\hlstr{'methyLImp'}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in library("{}methyLImp"{}): there is no package called 'methyLImp'}}\begin{alltt}
\hlcom{# load in methyLImp dataset}
\hlkwd{data}\hlstd{(gsm1647847)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning in data(gsm1647847): data set 'gsm1647847' not found}}\begin{alltt}
\hlcom{# display dimensions of data matrix}
\hlkwd{dim}\hlstd{(gsm1647847)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'gsm1647847' not found}}\end{kframe}
\end{knitrout}

\section{Suggested analysis workflow}

\subsection{Load data}

The methylation data array of either beta or M- values has to be split into a CpG labels vector and the corresponding methylation array.

\subsection{Example workflow}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{data}\hlstd{(gsm1647847)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning in data(gsm1647847): data set 'gsm1647847' not found}}\begin{alltt}
\hlkwd{data}\hlstd{(probeAnnotation21kdatMethUsed}\hlopt{$}\hlstd{Name)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning in data(probeAnnotation21kdatMethUsed\$Name): data set 'probeAnnotation21kdatMethUsed\$Name' not found}}\begin{alltt}
\hlcom{# load in methyLImp dataset and list of CpG involved in Horvat's epigenetic clock analysis}

\hlstd{match1}             \hlkwb{<-} \hlkwd{match}\hlstd{(probeAnnotation21kdatMethUsed}\hlopt{$}\hlstd{Name , gsm1647847[,}\hlnum{1}\hlstd{])}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in match(probeAnnotation21kdatMethUsed\$Name, gsm1647847[, 1]): object 'probeAnnotation21kdatMethUsed' not found}}\begin{alltt}
\hlstd{gsm1647847_21k}     \hlkwb{<-} \hlstd{gsm1647847[match1,]}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'gsm1647847' not found}}\begin{alltt}
\hlstd{gsm1647847_21k}     \hlkwb{<-} \hlkwd{t}\hlstd{(gsm1647847_21k[,}\hlopt{-}\hlnum{1}\hlstd{])}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in t(gsm1647847\_21k[, -1]): object 'gsm1647847\_21k' not found}}\begin{alltt}
\hlcom{# for instance select only CpG for Horvat's epigenetic clock }


\hlcom{# select sampling of missing data}

\hlstd{run_methyLImp} \hlkwb{<-} \hlkwa{function}\hlstd{(}\hlkwc{dat}\hlstd{,} \hlkwc{samp}\hlstd{) \{}
        \hlstd{out} \hlkwb{<-} \hlstd{dat}
        \hlstd{out[,samp]} \hlkwb{<-} \hlnum{NA}

        \hlkwa{for}\hlstd{(i} \hlkwa{in} \hlkwd{rownames}\hlstd{(dat)) \{}
                \hlstd{tmp} \hlkwb{<-} \hlstd{dat[i,samp]}
                \hlstd{dat[i,samp]} \hlkwb{<-} \hlnum{NA}
                \hlstd{outtmp} \hlkwb{<-} \hlkwd{methyLImp}\hlstd{(dat,}\hlkwc{min}\hlstd{=}\hlnum{0}\hlstd{,}\hlkwc{max}\hlstd{=}\hlnum{1}\hlstd{)}
                \hlstd{out[i,samp]} \hlkwb{<-} \hlstd{outtmp[i,samp]}
                \hlstd{dat[i,samp]} \hlkwb{<-} \hlstd{tmp}
        \hlstd{\}}
\hlstd{\}}
\hlcom{# Helper function to run method}

\hlstd{imputed_data} \hlkwb{=} \hlkwd{run_methyLImp}\hlstd{(gsm1647847_21k, samp)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in run\_methyLImp(gsm1647847\_21k, samp): object 'gsm1647847\_21k' not found}}\begin{alltt}
\hlcom{# run method}
\end{alltt}
\end{kframe}
\end{knitrout}

\section{References}

[1] Di Lena P, Sala C, Prodi A, Nardini C. Missing value estimation methods for DNA methylation data. submitted to Bioinformatics

\end{document}


